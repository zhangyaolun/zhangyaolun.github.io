new Vue({el:"#list",data:{oBackTopFixed:!1,preLoading:!0,itemList:[],page:1,count:10,norecordShow:!1},filters:{pricef:function(t){return t?"¥"+(parseInt(t)/100).toFixed(2):"0.00"}},mounted:function(){FastClick.attach(document.body),commentJs.toastLoading("加载中..."),commentJs.BackToTop("fix-block-r"),commentJs.kefuLogo("kefu_logo");var t=this;setTimeout(function(){t.oData(t.page,t.count)},10),window.addEventListener("scroll",this.handleScroll)},methods:{oData:function(i,t){var s=this;o.footprintSeach(i,t,function(t){var o=JSON.parse(JSON.stringify(t.result.list));if(1==i&&(s.itemList=[]),0<o.length){function e(e){var i="",s=[],n=(i=[],[]);return e.forEach(function(t,o){i=t.dateStr.split("-"),_t=i[0]+"年"+i[1]+"月"+i[2]+"日",t.odateStr=_t,s.push(_t)}),(s=commentJs.arrayTemp(s)).forEach(function(o,t){var s={dateStr:o,olist:[]};e.forEach(function(e,t){if(o==e.odateStr&&(e.isCollected?e.collectedImg="../../images/yishoucang@2x.png":e.collectedImg="../../images/shou@2x.png",e.productPageDto)){e.disabledInputTitle="","DownShelf"==e.productPageDto.status&&(e.disabledInputTitle="已下架");var i="";e.productPageDto.spuList.forEach(function(t,o){t.spuAttrList.forEach(function(t,o){0==o&&(i+=t.id+",")})}),i="["+i.substring(0,i.length-1)+"]",e.setSkuId="",e.setStock=0,e.productPageDto.skuList.forEach(function(t,o){t.skuCombination==i&&(e.setSkuId=t.id,e.setStock=t.stock)}),""!=e.setSkuId&&0==e.setStock&&(e.disabledInputTitle="无货"),s.olist.push(e)}}),n.push(s),console.log(n)}),n}$("body").removeClass("bgf"),s.norecordShow=!0,0==s.itemList.length?e(o).forEach(function(t,o){s.itemList.push(t)}):(e(o).forEach(function(t,o){s.itemList.push(t)}),s.itemList.forEach(function(e,t){s.itemList[t+1]&&e.dateStr==s.itemList[t+1].dateStr&&(s.itemList[t+1].olist.forEach(function(t,o){e.olist.push(t)}),s.itemList.splice(t+1,1))}))}else $("body").addClass("bgf"),1==i&&(s.norecordShow=!1);s.preLoading=!1})},footClick:function(t,o){window.location.href="OnShelf"==o?"../product/product_detail.html?goods_id="+t:"./shopLower.html"},footprintdel:function(){var e=this;o.footprintdelete(function(t){e.itemList=[],e.page=1,commentJs.toastTitle("已清空",""),$("body").addClass("bgf"),e.norecordShow=!1})},addCart:function(t,e){var i,s=this;if("DownShelf"!=s.itemList[t].olist[e].productPageDto.status&&""!=(i=s.itemList[t].olist[e].setSkuId)&&0!=s.itemList[t].olist[e].setStock){o.shopcarAll(function(t){var e=!0;t.result.forEach(function(t,o){t.cargoList.forEach(function(t,o){t.skuId==i&&(t.count>=t.sku.stock||256<=t.count)&&(e=!1)})}),e?o.shopcarAdd(i,1,function(t){commentJs.shopcarAll(),commentJs.toastTitle("加入购物车成功","")}):commentJs.toastTitle("数量超出范围","forbidden")})}},favorateFun:function(e,i){var s=this,t={collectType:"1",collectId:s.itemList[e].olist[i].linkId};if("DownShelf"!=s.itemList[e].olist[i].productPageDto.status)if(s.itemList[e].olist[i].isCollected){o.collectionDelete(t,function(t){s.itemList[e].olist[i].isCollected=!1,s.itemList[e].olist[i].collectedImg="../../images/shou@2x.png",commentJs.toastTitle("已取消收藏","")})}else{o.collectionSave(t,function(t){s.itemList[e].olist[i].isCollected=!0,s.itemList[e].olist[i].collectedImg="../../images/yishoucang@2x.png",commentJs.toastTitle("收藏成功","")})}},oBackTop:function(){document.body.scrollTop=0,document.documentElement.scrollTop=0},handleScroll:function(){var t=this,o=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;t.oBackTopFixed=100<o,$(window).height()+$(document).scrollTop()==$(document).height()&&(t.page++,t.oData(t.page,t.count))}}});