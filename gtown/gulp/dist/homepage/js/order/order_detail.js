new Vue({el:"#app",data:{curFalg:1,M_X_falg:!1,oMtabList:["全部","代付款","待发货","待收货"],oMtabFlag:0,oMitemList:{},preLoading:!0,oXtabList:["全部","代付款","待使用"],invoiceTitle:"不需要开发票",odatas:{keyword:"",fictitious:!1},page:1,count:20,orderStateImg:"../../images/daifa.png",endTime:"",fictitiousFalg:!0,dialogWrapper:!1},computed:{},filters:{orderCurrency:function(e){return e?{Submit:"待付款",Pay:"待发货",Delivering:"待收货",Reject:"退货",Refund:"退款",Cancel:"已取消",Received:"已完成"}[e]:""},currency:function(e){return e?(parseInt(e)/100).toFixed(2)+"元":"0.00"},dataFormatcurrency:function(e){return e?commentJs.dataFormat(e,1):""}},mounted:function(){var e=this;FastClick.attach(document.body),commentJs.homeHader("订单详情"),sessionStorage.removeItem("refund"),commentJs.toastLoading("加载中...");var t=commentJs.getUrlKey("orderNumber"),i=commentJs.getUrlKey("fictitious");t&&i?(e.odatas.fictitious=i,e.odatas.keyword=t,setTimeout(function(){e.oListData()},10)):e.preLoading=!1},methods:{oListData:function(){var t=this;t.preLoading=!0;o.userOrder(t.page,t.count,t.odatas,function(e){0<e.result.list.length&&e.result.list.forEach(function(i,e){if(0!=i.orderProduct.length&&0==e){var o=0,r={Cancel:"已取消",Pay:"退款",Received:"退货",Refund:"退款中",Reject:"退货中",RefundSuccess:"退款完成",RejectSuccess:"退货完成",RefundFail:"退款失败",RejectFail:"退货失败"};t.curFalg=1,i.fictitious?(t.curFalg=0,sessionStorage.setItem("curFalg",2),t.fictitiousFalg=!1):(t.curFalg=1,sessionStorage.setItem("curFalg",1),t.fictitiousFalg=!0),t.orderStateImg={Refund:"../../images/chuli.png",Reject:"../../images/chuli.png",Submit:"../../images/daishouhuo.png",Pay:"../../images/daifa.png",Delivering:"../../images/daishouhuo.png",Received:"../../images/yiwancheng.png",Cancel:"../../images/daishouhuo.png"}[i.orderState],i.orderProduct.forEach(function(e,t){"RefundSuccess"==e.productStatus||"RejectSuccess"==e.productStatus||"RefundFail"==e.productStatus||"RejectFail"==e.productStatus||"Refund"==e.productStatus||"Reject"==e.productStatus?e.refundTitleNum=2:e.refundTitleNum=1,console.log(e.refundTitleNum),e.refundTitle="",o+=parseInt(e.count),e.rate=parseInt(e.count)*parseInt(e.price)/parseInt(i.productTotalPrice)*i.orderPayment,e.payType=i.payType,"Pay"!=i.orderState||e.productStatus?e.refundTitle=r[e.productStatus]:e.refundTitle=r[i.orderState],"Received"==i.orderState?e.refundType=2:e.refundType=1}),i.oNum=o,t.oMitemList=i}t.endTime&&commentJs.fnTimeCountDown(t.endTime,function(){t.confirmOrder()}),t.preLoading=!1})})},btnMoreDel:function(){this.dialogWrapper=!0},btnCancel:function(){this.dialogWrapper=!1},confirmOrder:function(){var t=this;t.dialogWrapper=!1;o.userOrderConfirm(t.oMitemList.id,function(e){commentJs.toastTitle("收货成功",""),setTimeout(function(){t.oListData()},10)})},DownShelfClick:function(e,t){this.fictitiousFalg&&(window.location.href="OnShelf"==t?"../product/product_detail.html?goods_id="+e:"../member/shopLower.html")},oXtabClick:function(e){"退款"!=e.refundTitle&&"退货"!=e.refundTitle||(sessionStorage.setItem("refund",JSON.stringify(e)),window.location.href="order_refund.html?uid="+this.oMitemList.userId)}}});